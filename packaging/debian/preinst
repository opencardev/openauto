#!/bin/bash
# Pre-installation script

set -e

# Stop services if they're running
if systemctl is-active --quiet openauto 2>/dev/null; then
    echo "Stopping OpenAuto service..."
    systemctl stop openauto
fi

if systemctl is-active --quiet openauto-btservice 2>/dev/null; then
    echo "Stopping OpenAuto Bluetooth service..."
    systemctl stop openauto-btservice
fi

# Backup existing configuration if present
if [ -d "/etc/openauto" ]; then
    echo "Backing up existing configuration..."
    cp -r /etc/openauto /etc/openauto.backup.$(date +%Y%m%d_%H%M%S)
fi

exit 0
