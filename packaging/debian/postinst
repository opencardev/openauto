#!/bin/bash
# Post-installation script

set -e

echo "ğŸš€ Configuring OpenAuto..."

# Run the setup script
/opt/openauto/scripts/openauto-setup.sh

# Start services
echo "Starting OpenAuto services..."
systemctl start openauto.service
systemctl start openauto-btservice.service

# Check service status
sleep 2
if systemctl is-active --quiet openauto; then
    echo "âœ… OpenAuto service started successfully"
else
    echo "âš ï¸  OpenAuto service failed to start - check logs with: journalctl -u openauto"
fi

if systemctl is-active --quiet openauto-btservice; then
    echo "âœ… OpenAuto Bluetooth service started successfully"
else
    echo "âš ï¸  OpenAuto Bluetooth service failed to start - check logs with: journalctl -u openauto-btservice"
fi

echo ""
echo "ğŸ“‹ OpenAuto Installation Complete!"
echo ""
echo "ğŸ”§ Configuration:"
echo "   â€¢ Main config: /etc/openauto/openauto.conf"
echo "   â€¢ Logger config: /etc/openauto/logger.conf"
echo "   â€¢ Services config: /etc/openauto/services.conf"
echo ""
echo "ğŸ“Š Monitoring:"
echo "   â€¢ Service status: systemctl status openauto"
echo "   â€¢ Logs: journalctl -u openauto -f"
echo "   â€¢ REST API: http://localhost:8080"
echo ""
echo "ğŸš— Ready for Android Auto connections!"

exit 0
